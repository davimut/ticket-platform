<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>Dettagli Ticket</title>
	<link rel="stylesheet" href="/webjars/bootstrap/5.1.3/css/bootstrap.min.css">
	<link rel="stylesheet" href="/css/styles.css">
	<style>
		html,
		body {
			height: 100%;
			margin: 0;
		}

		body {
			display: flex;
			flex-direction: column;
		}

		main {
			flex: 1;
		}

		header {
			background-color: #343a40;
			padding: 5px 0;
			/* Reduced padding */
			border-bottom: 1px solid #dee2e6;
		}

		header h1 {
			margin: 0;
			color: #fff;
			font-size: 1.5rem;
			/* Adjusted font size */
		}

		header nav {
			margin-top: 5px;
			/* Reduced margin */
		}

		header nav a {
			color: #fff;
			margin-right: 15px;
			font-size: 0.9rem;
			/* Smaller font size */
		}

		header nav a:hover {
			text-decoration: underline;
		}

		footer {
			background-color: #f8f9fa;
			padding: 5px 0;
			/* Reduced padding */
			border-top: 1px solid #dee2e6;
		}

		footer p {
			margin: 0;
			font-size: 0.9rem;
			/* Smaller font size */
		}

		.container {
			max-width: 800px;
		}

		.card {
			border-radius: 0.25rem;
		}

		.btn {
			border-radius: 0.25rem;
		}

		.list-unstyled {
			padding-left: 0;
		}
	</style>
</head>

<body>
	<header class="bg-dark text-white mb-4 py-3">
		<div class="container">
			<div class="d-flex justify-content-between align-items-center">
				<h1 class="h3">Dettagli Ticket</h1>
				<nav class="nav">
					<a class="nav-link" href="/admin">Home</a>
					<a class="nav-link" href="http://localhost:8080/logout">Logout</a>
				</nav>
			</div>
		</div>
	</header>

	<main class="container my-5">
		<section class="mb-5">
			<h2 class="mb-4">Informazioni Ticket</h2>
			<div class="card p-4">
				<p><strong>ID:</strong> <span th:text="${ticket.id}"></span></p>
				<p><strong>Title:</strong> <span th:text="${ticket.titolo}"></span></p>
				<p><strong>Description:</strong> <span th:text="${ticket.descrizione}"></span></p>
				<p><strong>Status:</strong> <span th:text="${ticket.stato}"></span></p>
				<p><strong>Data:</strong> <span th:text="${ticket.getDataCreazioneFormattata}"></span></p>
				<div class="mt-4">
					<div class="mt-4">
						<a href="#" th:href="@{/admin/tickets/{id}/edit(id=${ticket.id})}"
							class="btn btn-warning">Modifica Ticket</a>
						<form th:action="@{/admin/tickets/{id}/delete(id=${ticket.id})}" method="post"
							style="display:inline;">
							<button type="submit" class="btn btn-danger"
								onclick="return confirm('Sei sicuro di voler eliminare questo ticket?');">Cancella
								Ticket</button>
						</form>
					</div>
				</div>
			</div>
		</section>

		<section class="mb-5">
			<h3 class="h4">Note</h3>
			<ul class="list-unstyled">
				<li class="border-bottom mb-3 pb-3 d-flex justify-content-between align-items-start"
					th:each="note : ${notes}">
					<div>
						<h5 class="mb-1" th:text="${note.autore.username}"></h5>
						<small class="text-muted" th:text="${note.getDataCreazioneFormattata}"></small>
						<p class="mb-0 mt-2" th:text="${note.testo}"></p>
					</div>
					<form th:action="@{/admin/notes/{id}/delete(id=${note.id})}" method="post" class="ms-3">
						<input type="hidden" name="ticketId" th:value="${ticket.id}">
						<input type="hidden" name="userId" th:value="${userId}">
						<button type="submit" class="btn btn-danger btn-sm"
							onclick="return confirm('Sei sicuro di voler eliminare questa nota?');">Cancella</button>
					</form>
				</li>
			</ul>
			<form th:action="@{/admin/tickets/{id}/addNote(id=${ticket.id})}" method="post" class="mt-4">
				<div class="form-group">
					<label for="text">Aggiungi Nota</label>
					<textarea id="text" name="text" class="form-control" rows="4" required></textarea>
				</div>
				<input type="hidden" name="userId" th:value="${userId}">
				<button type="submit" class="btn btn-dark">Aggiungi Nota</button>
			</form>
		</section>
	</main>

	<footer class="bg-light text-center py-3 mt-auto">
		<div class="container">
			<p>&copy; 2024 Davimut</p>
		</div>
	</footer>

	<!-- Bootstrap JS -->
	<script src="/webjars/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
</body>

</html>